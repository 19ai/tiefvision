#/bin/bash

trap 'exit 1' ERR

ROOT=$(realpath $(dirname ${BASH_SOURCE[0]})/../..)
DOCKER_IMAGE_NAME=paucarre/tiefvision-db

touch $ROOT/src/h2/tiefvision.mv.db

echo "Building $DOCKER_IMAGE_NAME"
docker build -t $DOCKER_IMAGE_NAME $ROOT/src/h2

echo "Running $DOCKER_IMAGE_NAME"
docker run \
  --rm \
  --interactive --tty  \
  --publish 8082:8082 \
  --publish 9092:9092 \
  --volume $ROOT/src/h2/tiefvision.mv.db:/root/tiefvision.mv.db \
  $DOCKER_IMAGE_NAME
